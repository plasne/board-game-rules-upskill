$schema: https://azuremlschemas.azureedge.net/promptflow/latest/Flow.schema.json
environment:
  python_requirements_txt: requirements.txt
inputs:
  answer:
    type: string
    default: Dracula's hand size in Fury of Dracula 4th edition is five encounter
      cards [doc1].
  context:
    type: string
    default: a snappy little turtle
  question:
    type: string
    default: in Fury of Dracula 4th edition, what is Dracula's hand size?
outputs:
  eval_results:
    type: string
    reference: ${normalize.output}
  eval_recorded_statuscode:
    type: string
    reference: ${record_eval.output}
nodes:
- name: groundedness
  type: llm
  source:
    type: code
    path: groundedness.jinja2
  inputs:
    deployment_name: gpt-4
    temperature: 0
    answer: ${inputs.answer}
    context: ${inputs.context}
    question: ${inputs.question}
  connection: open_ai_connection
  api: chat
- name: relevancy
  type: llm
  source:
    type: code
    path: relevancy.jinja2
  inputs:
    deployment_name: gpt-4
    temperature: 0
    answer: ${inputs.answer}
    question: ${inputs.question}
    context: ${inputs.context}
    chat_history_text: "[]"
  connection: open_ai_connection
  api: chat
- name: coherence
  type: llm
  source:
    type: code
    path: coherence.jinja2
  inputs:
    deployment_name: gpt-4
    temperature: 0
    answer: ${inputs.answer}
    question: ${inputs.question}
  connection: open_ai_connection
  api: chat
- name: normalize
  type: python
  source:
    type: code
    path: normalize.py
  inputs:
    groundedness: ${groundedness.output}
    relevancy: ${relevancy.output}
    coherance: ${coherence.output}
- name: record_eval
  type: python
  source:
    type: code
    path: record_eval.py
  inputs:
    evals: ${normalize.output}
    eval_set: beta
    eval_desc: no desc from me
